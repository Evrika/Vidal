{% extends 'VidalMainBundle::layout.html.twig' %}

{% set withPhoto = publication.photo and is_file(publication.photo.path) %}

{% block nav %}
	<div class="breadcrumbs">
		<a href="{{ path('index') }}">Видаль</a>
		<i></i>
		<a href="{{ path('news') }}">Новости</a>
	</div>
{% endblock %}


{% block content %}
    <div class="menu-drugs">
        <div class="tabs" style="width: 520px">
            <table style="width: 100%" border="0" cellpadding="0" cellspacing="0">
                <tr>
                    {#<td style="width: 20%; text-align: center;">#}
                        {#<a href="{{ path('astrazeneca_index') }}">Видеолекции</a>#}
                    {#</td>#}
                    <td style="width: 20%; text-align: center;">
                        <a href="{{ path('astrazeneca_news') }}" class="active">Статьи</a>
                    </td>
                    <td style="width: 20%; text-align: center;">
                        <a href="{{ path('astrazeneca_faq') }}">Вопрос-ответ</a>
                    </td>
                    <td style="width: 20%; text-align: center;">
                        <a href="{{ path('astrazeneca_testing') }}" >Тестирование</a>
                    </td>
                    <td style="width: 20%; text-align: center;">
                        <a href="{{ path('astrazeneca_map') }}" >Карта</a>
                    </td>
                </tr>
            </table>
        </div>
    </div>
    <h1>
        {{ publication|raw }}
        {# админу карандашик на правку #}
        {% if isAdmin %}
            <a class="admin-edit fade" target="_blank"
               href="{{ path('admin_vidal_drug_publication_edit', {'id':publication.id}) }}">
                <img src="{{ asset('bundles/vidalmain/images/edit.png') }}"/>
            </a>
        {% endif %}
    </h1>

	<div class="publication">
		{% if withPhoto %}
			<div class="publication-header with-photo">
				<div class="photo">
					<img src="{{ publication.photo.path }}" alt="{{ publication.title }}"/>
				</div>
			</div>
		{% endif %}

		{% if publication.video and publication.video.path is defined %}
			{% set width = publication.videoWidth > 480 ? 480 : publication.videoWidth %}
			{% set height = publication.videoWidth > 480
			? (publication.videoHeight * 480 / publication.videoWidth) | number_format(0)
			: publication.videoHeight %}

			<p id="player1"></p>

			<script src="{{ asset('bundles/vidalmain/javascripts/swfobject.js') }}" type="text/javascript"></script>
			<script type="text/javascript">
				var so = new SWFObject('/players/uppod.swf', 'mpl', {{ width }}, {{ height }}, '8');
				so.addParam('allowscriptaccess', 'always');
				so.addParam('allowfullscreen', 'true');
				so.addVariable('height', '{{ height }}');
				so.addVariable('width', '{{ width }}');
				so.addVariable('file', '{{ publication.video.path }}');
				so.addVariable('bufferlength', '10');
				so.addVariable('autostart', 'false');
				so.addVariable('enablejs', 'true');
				so.write('player1');
			</script>
		{% endif %}

		<div class="publication-body">
			{{ publication.body|raw }}
		</div>

		<div class="publication-footer">
			<span class="publication-date">{{ publication.created|date('d.m.Y') }}</span>
		</div>
	</div>

{% endblock %}


{% block stylesheets %}
	{{ parent() }}
	<style type="text/css">
		.publication {
			font-size: 15px;
			position:  relative;
		}
		.publication-body p:first-child {
			margin-top: 0;
		}
		.publication-header {
			margin-bottom: 20px;
			overflow:      hidden;
		}
		.publication-header .photo {
			display:    inline-block;
			float:      left;
			margin-top: 2px;
		}
		.publication-header .photo img {
			max-width: 185px;
		}
		.publication-header.with-photo .publication-announce {
			margin-left: 205px;
		}
		.publication-footer {
			overflow: hidden;
		}
		.publication-date {
			display:    inline-block;
			float:      right;
			text-align: right;
			font-size:  13px;
			font-style: italic;
			color:      gray;
		}
        .tabs a{
            width: 100%;
            display: block;
            text-align: center;
            padding: 7px 0;
        }
	</style>
{% endblock %}
