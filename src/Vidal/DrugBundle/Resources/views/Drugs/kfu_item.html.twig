{% extends 'VidalDrugBundle::vidal_layout.html.twig' %}


{% block title %}
	<h1>{{ kfu.Name|raw }}</h1>
{% endblock %}


{% block nav %}
	<div class="breadcrumbs">
		<a href="{{ path('index') }}">Видаль</a>
		<i></i>
		<a href="{{ path('kfu') }}">Клинико-фармакологические указатели</a>
	</div>
{% endblock %}


{% block vidal %}

	{% if parent %}
		<div class="block">
			<div class="block-head">Входит в группу</div>
			<div class="block-content">
				<table class="products-table">
					<tr>
						<td style="width:90px">
							{{ parent.Code }}
						</td>
						<td>
							<a href="{{ path('kfu_item', {'code':parent.Code}) }}" class="no-underline">
								{{ parent.Name|raw }}
							</a>
						</td>
					</tr>
				</table>
			</div>
		</div>
	{% endif %}

	{% if children is not empty %}
		<div class="block">
			<div class="block-head">
				{{ children|length == 1 ? 'Включает группу' : 'Включает группы' }}
			</div>
			<div class="block-content">
				<table class="products-table">
					{% for child in children %}
						<tr>
							<td style="width:90px">
								{{ child.Code }}
							</td>
							<td>
								<a href="{{ path('kfu_item', {'code':child.Code}) }}" class="no-underline">
									{{ child.Name|raw }}
								</a>
							</td>
						</tr>
					{% endfor %}
				</table>
			</div>
		</div>
	{% endif %}

	{% if groups is defined %}
		{% for name, group in groups %}
			<div class="group">
				<div class="molecules">
					{% if group.molecules|length == 1 %}
						<span>Активное вещество: </span>
					{% elseif group.molecules|length > 1 %}
						<div>Активные вещества</div>
					{% endif %}

					{% for MoleculeID in group.molecules %}
						<a href="{{ path('molecule', {'MoleculeID':MoleculeID}) }}">
							{{ molecules[MoleculeID]|upper|raw }}
						</a>
						{% if not loop.last %}
							+
						{% endif %}
					{% endfor %}
				</div>
				{% include 'VidalDrugBundle:Vidal:render_products.html.twig' with {'products':group.products|values} %}
			</div>
		{% endfor %}
	{% elseif children is empty %}
		<div class="no-results block">
			Не найдено препаратов
		</div>
	{% endif %}

	{% if unusedProducts is defined and unusedProducts is not empty %}
		<div class="group">
			<div class="molecules">
				<span>Остальные препараты группы</span>
			</div>
		</div>
		{% include 'VidalDrugBundle:Vidal:render_products.html.twig' with {'products':unusedProducts} %}
	{% endif %}

{% endblock %}


{% block stylesheets %}
	{{ parent() }}
	<style type="text/css">
		.molecules {
			margin-top: 15px;
			padding:    3px 5px;
			background: #e6e6e6;
			border:     1px solid #ccc;
		}
		.molecules > div, .molecules > span {
			font-size:     12px;
			color:         #476173;
			margin-bottom: 2px;
		}
		.molecules a {
			text-decoration: none;
			font-weight:     bold;
			color:           #333;
			font-size:       12px;
		}
		.molecules a:hover {
			text-decoration: underline;
		}
	</style>
{% endblock %}