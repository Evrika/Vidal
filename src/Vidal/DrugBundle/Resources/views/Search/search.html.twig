{% extends 'VidalDrugBundle::vidal_layout.html.twig' %}


{% block vidal %}
	<style>
		.any {
			display: none;
		}
		.btn-gray {
			-moz-box-shadow:       inset 0px 1px 0px 0px #ffffff;
			-webkit-box-shadow:    inset 0px 1px 0px 0px #ffffff;
			box-shadow:            inset 0px 1px 0px 0px #ffffff;
			background:            -webkit-gradient(linear, left top, left bottom, color-stop(0.05, #ededed), color-stop(1, #dfdfdf));
			background:            -moz-linear-gradient(top, #ededed 5%, #dfdfdf 100%);
			background:            -webkit-linear-gradient(top, #ededed 5%, #dfdfdf 100%);
			background:            -o-linear-gradient(top, #ededed 5%, #dfdfdf 100%);
			background:            -ms-linear-gradient(top, #ededed 5%, #dfdfdf 100%);
			background:            linear-gradient(to bottom, #ededed 5%, #dfdfdf 100%);
			filter:                progid:DXImageTransform.Microsoft.gradient(startColorstr='#ededed', endColorstr='#dfdfdf', GradientType=0);
			background-color:      #ededed;
			-moz-border-radius:    6px;
			-webkit-border-radius: 6px;
			border-radius:         6px;
			border:                1px solid #dcdcdc;
			display:               inline-block;
			cursor:                pointer;
			color:                 #777777;
			font-family:           arial;
			font-size:             15px;
			font-weight:           bold;
			padding:               6px 24px;
			text-decoration:       none;
			text-shadow:           0px 1px 0px #ffffff;
		}
		.btn-gray:hover {
			background:       -webkit-gradient(linear, left top, left bottom, color-stop(0.05, #dfdfdf), color-stop(1, #ededed));
			background:       -moz-linear-gradient(top, #dfdfdf 5%, #ededed 100%);
			background:       -webkit-linear-gradient(top, #dfdfdf 5%, #ededed 100%);
			background:       -o-linear-gradient(top, #dfdfdf 5%, #ededed 100%);
			background:       -ms-linear-gradient(top, #dfdfdf 5%, #ededed 100%);
			background:       linear-gradient(to bottom, #dfdfdf 5%, #ededed 100%);
			filter:           progid:DXImageTransform.Microsoft.gradient(startColorstr='#dfdfdf', endColorstr='#ededed', GradientType=0);
			background-color: #dfdfdf;
		}
		.btn-gray:active {
			position: relative;
			top:      1px;
		}
		.any-btn {
			display:    block;
			text-align: center;
		}
		.any-title {
			margin-bottom: 12px;
		}
	</style>

	{% include 'VidalDrugBundle:Search:search_info.html.twig' %}

	{# Найдено препаратов #}
	{% if productsPagination is defined %}
		{% if productsPagination is not empty %}
			{% if anyOfWord %}
				<div class="any-title no-results">
					<div>
						Препаратов по запросу <span>{{ q }}</span> не найдено.
					</div>
					<div>
						Отобразить результаты по любому из слов <span>{{ anyOfWord }}</span>?
					</div>
				</div>
				<a href="#" class="any-btn btn-gray">Показать</a>
				<script type="text/javascript">
					$(document).ready(function() {
						$('.any-btn').click(function(e) {
							e.preventDefault();
							$(this).remove();
							$('.any-title').remove();
							$('.any').show();
						});
					});
				</script>
			{% endif %}

			<div class="products{{ anyOfWord ? ' any' }}">
				<div class="block">
					<div class="block-anons">
						<div class="block-head">
							Найдено препаратов{{ anyOfWord ? ' по любому из слов' }}:
							<span>{{ productsPagination.totalItemCount }}</span>
						</div>
					</div>
				</div>
				<div class="navigation">
					{{ knp_pagination_render(productsPagination) }}
				</div>
				{% include 'VidalDrugBundle:Vidal:render_products.html.twig' with {'products':productsPagination.items} %}
				{% if productsPagination.totalItemCount > 15 %}
					<div class="navigation">
						{{ knp_pagination_render(productsPagination) }}
					</div>
				{% endif %}
			</div>
		{% elseif t == 'product' %}
			<div class="no-results">
				Не найдено результатов по препарату <span>{{ q }}</span>
			</div>
		{% endif %}
	{% endif %}

	{# Найдено Медицинских изделий #}
	{% if mis is defined %}
		<div class="block">
			<div class="block-anons">
				<div class="block-head">
					Найдено медицинских изделий (МИ): <span>{{ mis|length }}</span>
				</div>
			</div>
		</div>
		{% include 'VidalDrugBundle:Vidal:render_products.html.twig' with {'products':mis, 'pictures':mi_pictures, 'companies':mi_companies, 'infoPages':mi_infoPages} %}
	{% endif %}

	{# Найдено БАДов #}
	{% if bads is defined %}
		<div class="block">
			<div class="block-anons">
				<div class="block-head">
					Найдено БАДов: <span>{{ bads|length }}</span>
				</div>
			</div>
		</div>
		{% include 'VidalDrugBundle:Vidal:render_products.html.twig' with {'products':bads, 'pictures':bad_pictures, 'companies':bad_companies, 'infoPages':bad_infoPages} %}
	{% endif %}

	{# Найдено активных веществ #}
	{% if molecules is defined %}
		{% if molecules is not empty %}
			<div class="block">
				<div class="block-anons">
					<div class="block-head">
						Найдено активных веществ: <span>{{ molecules|length }}</span>
					</div>
				</div>
			</div>
			{% include 'VidalDrugBundle:Vidal:render_molecules.html.twig' %}
		{% elseif t == 'molecule' %}
			<div class="no-results">
				Не найдено результатов по активному веществу <span>{{ q }}</span>
			</div>
		{% endif %}
	{% endif %}

	{# Найдено АТХ #}
	{% if atcCodes is defined and atcCodes is not empty %}
		<div class="block">
			<div class="block-head anons"
				 title="Анатомо-Терапевтически-Химическая (АТХ) система классификации (ATC)">
				Найдено кодов АТХ: <span>{{ atcCodes|length }}</span>
			</div>

			<table class="products-table">
				<tr class="products-table-header">
					<td style="width:10%">АТХ код</td>
					<td style="width:40%">Название</td>
					<td style="width:40%">Латинское название</td>
					<td style="width:10%">Входит в&nbsp;группу</td>
				</tr>
				{% for code, atc in atcCodes %}
					<tr>
						<td>
							<a href="{{ path('atc_item', {'ATCCode':atc.ATCCode}) }}"
							   class="no-underline">{{ atc.ATCCode }}</a>
						</td>
						<td>{{ atc.RusName }}</td>
						<td>{{ atc.EngName }}</td>
						<td>
							{% if atc.ParentATCCode is not empty %}
								<a href="{{ path('atc', {'ATCCode':atc.ParentATCCode}) }}"
								   class="no-underline">{{ atc.ParentATCCode }}</a>
							{% endif %}
						</td>
					</tr>
				{% endfor %}
			</table>
		</div>
	{% elseif t == 'atc' %}
		<div class="no-results">
			Не найдено результатов по AТХ коду <span>{{ q }}</span>
		</div>
	{% endif %}

	{# поиск по компании #}
	{% include 'VidalDrugBundle:Search:search_company.html.twig' %}

	{# Найдено заболеваний #}
	{% if articles is defined %}
		{% if articles is not empty %}
			<div class="block">
				<div class="block-anons">
					<div class="block-head">
						Найдено результатов по заболеваниям: <span>{{ articles|length }}</span>
					</div>
				</div>
			</div>
			{% include 'VidalDrugBundle:Vidal:render_articles.html.twig' %}
		{% elseif t == 'disease' %}
			<div class="no-results">
				Не найдено результатов по заболеванию <span>{{ q }}</span>
			</div>
		{% endif %}
	{% endif %}

	{# если общий поиск не дал результатов #}
	{% if t == 'all'
	and (productsPagination is not defined or productsPagination is empty)
	and (molecules is not defined or molecules is empty)
	and (search_infoPages is empty and search_companies is empty)
	and (bads is not defined or bads is empty)
	and (atcCodes is not defined or atcCodes is empty)
	and (articles is not defined or articles is empty) %}
		<div class="no-results">
			Не найдено результатов
		</div>
	{% endif %}

{% endblock %}


{% block stylesheets %}
	{{ parent() }}
	<style type="text/css">
		.products-table {
			font-size: 13px;
		}
		.no-results {
			margin: 30px 0 24px;
		}
	</style>
{% endblock %}